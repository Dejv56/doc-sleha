<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_install.xml" version="5.0" xml:id="cha-ha-install">
<?dbfo-need height="20em"?>


 <title>Installing the High Availability Extension</title>
 <info>
      <abstract>
        <para>If you are setting up a High Availability cluster with <phrase role="roductnamereg"><phrase os="sles">SUSEÂ® Linux Enterprise High Availability Extension</phrase></phrase> for the first time, the
    easiest way is to start with a basic two-node cluster. You can also use the
    two-node cluster to run some tests. Afterward, you can add more
    nodes by cloning existing cluster nodes with AutoYaST. The cloned nodes will
    have the same packages installed and the same system configuration as the
    original ones.
   </para>
        <para>
    If you want to upgrade an existing cluster that runs an older version of 
    <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>, refer to <xref linkend="cha-ha-migration"/>.
   </para>
      </abstract>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer/>
        <dm:status>editing</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>no</dm:translation>
        <dm:languages/>
        <dm:release/>
        <dm:repository/>
      </dm:docmanager>
    </info>
    <sect1 xml:id="sec-ha-install-manual">
  <title>Manual Installation</title>
  <para>
   For the manual installation of the packages for High Availability Extension refer to
   <xref linkend="art-sleha-install-quick"/>. It leads you through the setup of a
   basic two-node cluster.
  </para>
 </sect1>
  <sect1 xml:id="sec-ha-installation-autoyast">
  <title>Mass Installation and Deployment with AutoYaST</title>

  <para>
   After you have installed and set up a two-node cluster, you can extend the
   cluster by cloning existing nodes with AutoYaST and adding the clones to the cluster.
  </para>
   
   <para>AutoYaST uses profiles that contains installation and configuration data.
   A profile tells AutoYaST what to install and how to configure the installed system to
   get a ready-to-use system in the end. This profile can then be used
   for mass deployment in different ways (for example, to clone existing
   cluster nodes).</para>

   <para>
    For detailed instructions on how to use AutoYaST in various scenarios,
    see the <link xlink:href="https://documentation.suse.com/sles/15-SP2/html/SLES-all/book-autoyast.html">
     <citetitle>AutoYaST Guide</citetitle> for SUSE Linux Enterprise Server <phrase role="productnumber"><phrase os="sles">15 SP2</phrase></phrase></link>.
   </para>

   <important>
    <title>Identical Hardware</title>
    <para>
     <xref linkend="pro-ha-installation-clone-node"/> assumes you are rolling
     out <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles">15 SP2</phrase></phrase> to a set of machines with identical hardware
     configurations.
    </para>
    <para>
     If you need to deploy cluster nodes on non-identical hardware, refer to the
     <citetitle>SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles">15 SP2</phrase></phrase> Deployment Guide</citetitle>,
     chapter <citetitle>Automated Installation</citetitle>, section
     <citetitle>Rule-Based Autoinstallation</citetitle>.
    </para>
   </important>



  <procedure xml:id="pro-ha-installation-clone-node">
   <title>Cloning a Cluster Node with AutoYaST</title>
   <step>
    <para>
     Make sure the node you want to clone is correctly installed and
     configured. For details, see the <citetitle>Installation and Setup Quick Start</citetitle> for
     <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> or
     <xref linkend="cha-ha-ycluster"/>.
    </para>
   </step>
   <step>
    <para>
     Follow the description outlined in the <citetitle>SUSE Linux Enterprise
     <phrase role="productnumber"><phrase os="sles">15 SP2</phrase></phrase> Deployment Guide</citetitle> for simple mass
     installation. This includes the following basic steps:
    </para>
    <substeps performance="required">
     <step>
      <para>
       Creating an AutoYaST profile. Use the AutoYaST GUI to create and modify
       a profile based on the existing system configuration. In AutoYaST,
       choose the <guimenu>High Availability</guimenu> module and click the
       <guimenu>Clone</guimenu> button. If needed, adjust the configuration
       in the other modules and save the resulting control file as XML.
      </para>

      <para>
       If you have configured DRBD, you can select and clone this module in
       the AutoYaST GUI, too.
      </para>
     </step>
     <step>
      <para>
       Determining the source of the AutoYaST profile and the parameter to
       pass to the installation routines for the other nodes.
      </para>
     </step>
     <step>
      <para>
       Determining the source of the SUSE Linux Enterprise Server and <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>
       installation data.
      </para>
     </step>
     <step>
      <para>
       Determining and setting up the boot scenario for autoinstallation.
      </para>
     </step>
     <step>
      <para>
       Passing the command line to the installation routines, either by
       adding the parameters manually or by creating an
       <filename>info</filename> file.
      </para>
     </step>
     <step>
      <para>
       Starting and monitoring the autoinstallation process.
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   After the clone has been successfully installed, execute the following
   steps to make the cloned node join the cluster:
  </para>

  <procedure xml:id="pro-ha-installation-clone-start">
   <title>Bringing the Cloned Node Online</title>
   <step>
    <para>
     Transfer the key configuration files from the already configured nodes
     to the cloned node with Csync2 as described in
     <xref linkend="sec-ha-installation-setup-csync2"/>.
    </para>
   </step>
   <step>
    <para>
     To bring the node online, start the Pacemaker service on the cloned
     node as described in <xref linkend="sec-ha-installation-start"/>.
    </para>
   </step>
  </procedure>

  <para>
   The cloned node will now join the cluster because the
   <filename>/etc/corosync/corosync.conf</filename> file has been applied to
   the cloned node via Csync2. The CIB is automatically synchronized
   among the cluster nodes.
  </para>
 </sect1>
</chapter>
