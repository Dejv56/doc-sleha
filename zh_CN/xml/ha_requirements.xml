<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:dm="urn:x-suse:ns:docmanager" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_requirements.xml" version="5.0" xml:id="cha.ha.requirements">
  <?dbfo-need height="10em"?>


  <title>系统要求和建议</title>
 <info>
      <dm:docmanager>
        <dm:bugtracker>
          <dm:assignee>taroth@suse.com</dm:assignee>
        </dm:bugtracker>
        <dm:translation>yes</dm:translation>
      </dm:docmanager>
      <abstract>
        <para>
    下面的小节说明了系统要求以及 <phrase role="roductnamereg"><phrase os="sles">SUSE® Linux Enterprise High Availability Extension</phrase></phrase> 的一些先决条件。此外，还提供了有关群集设置的建议。
   </para>
      </abstract>
    </info>
    <sect1 xml:id="sec.ha.requirements.hw">
  <title>硬件要求</title>

  <para>
   以下列表指出了基于 <phrase role="roductnamereg"><phrase os="sles">SUSE® Linux Enterprise High Availability Extension</phrase></phrase> 的群集的硬件要求。这些要求表示最低硬件配置。根据群集的用途，可能会需要其他硬件。
  </para>

  <variablelist>
   <varlistentry>
    <term>服务器</term>
    <listitem>
     <para> 安装了<xref linkend="sec.ha.requirements.sw"/>中指定的软件的 1 到 32 台 Linux 服务器。 </para>
     <para>
      服务器可以是裸机，也可以是虚拟机。两者不要求有相同的硬件（内存、磁盘空间等），但们必须具有相同的体系结构。不支持跨平台群集。
     </para>
     <para> 使用 <literal>pacemaker_remote</literal> 可扩展群集使之突破 32 个节点的限制，包含更多的 Linux 服务器。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>通讯通道</term>
    <listitem>
       <para>
       每个群集节点至少有两个 TCP/IP 通讯媒体。网络设备必须支持您要用于群集通讯的通讯方式：多路广播或单路广播。通讯媒体应支持 100 Mbit/s 或更高的数据传送速度。对于受支持的群集设置，要求有两个或更多冗余通讯路径。这可通过以下方式实现：</para>
       <itemizedlist>
        <listitem>
         <para>
          网络设备绑定（首选）。
         </para>
        </listitem>
        <listitem>
         <para>
          Corosync 中的另一个通讯通道。
         </para>
        </listitem>
       </itemizedlist>
     <para>有关细节，请分别参见<xref linkend="cha.ha.netbonding"/>和<xref linkend="pro.ha.installation.setup.channel2"/>。
      
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>节点屏蔽/STONITH</term>
    <listitem>
      <para>
      为了避免发生<quote>节点分裂</quote>的情况，群集需要有节点屏蔽机制。在节点分裂的情况下，群集节点会由于硬件或软件故障或网络连接断开而分成两个或更多彼此无法联系的组。而屏蔽机制会隔离存在问题的节点（通常的做法是重设置该节点或关闭其电源）。这也称为 STONITH（<quote>Shoot the other node in the head</quote>，关闭其他节点）。节点屏蔽机制可以是物理设备（电源开关），也可以是 SBD（按磁盘 STONITH）等机制再结合检查包。使用 SBD 需要有共享存储。
     </para>
     <para>除非使用了 SBD，否则高可用性群集中的每个节点都必须至少有一个 STONITH 设备。强烈建议每个节点上有多个 STONITH 设备。</para>
      <important>
      <title>无 STONITH 资源不受支持</title>
      <itemizedlist>
       <listitem>
        <para>您必须为群集配置节点屏蔽机制。</para>
       </listitem>
       <listitem>
        <para>全局群集选项 <systemitem>stonith-enabled</systemitem> 和 <systemitem>startup-fencing</systemitem> 必须设置为 <literal>true</literal>。如果您更改这些选项，将会失去支持。</para>
       </listitem>
      </itemizedlist>
      </important>
    </listitem>
  </varlistentry>
  </variablelist>
 </sect1>
<?dbfo-need height="10em"?>


 <sect1 xml:id="sec.ha.requirements.sw">
  <title>软件要求</title>

  <para>
   在将组成群集的所有节点上，都必须安装以下软件。
  </para>



  <itemizedlist>
   <listitem>
     <para>
   SUSE® Linux Enterprise Server <phrase role="productnumber"><phrase os="sles">12 SP3</phrase></phrase>（含所有可用的联机更新）
  </para>
   </listitem>
   <listitem>
     <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles"> 12 SP3</phrase></phrase>（含所有可用的联机更新）
  </para>
   </listitem>
   <listitem>
    <para>
     （可选）对于 Geo 群集：Geo Clustering for SUSE Linux Enterprise High Availability Extension <phrase role="productnumber"><phrase os="sles">12 SP3</phrase></phrase>（含所有可用联机更新）
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sec.ha.requirements.disk">
  <title>储存要求</title>

  <para>
   有些服务需要使用共享储存。如果使用外部 NFS 共享，必须能够从所有群集节点通过冗余通讯路径可靠地访问该共享。</para>
  <para>为确保数据的高可用性，我们建议您为群集设置共享磁盘系统（储存区域网络，简称 SAN）。如果使用共享磁盘子系统，请确保符合以下要求：
  </para>

  <itemizedlist>
   <listitem>
    <para>
     根据制造商的说明正确设置共享磁盘系统并且共享磁盘系统可正确运行。
    </para>
   </listitem>
   <listitem>
    <para>
     共享磁盘系统中包含的磁盘应配置为使用镜像或 RAID，来为共享磁盘系统增加容错性。建议使用基于硬件的 RAID。所有配置都不支持基于主机的软件 RAID。
    </para>
   </listitem>
   <listitem>
    <para>
     如果准备对共享磁盘系统访问使用 iSCSI，则请确保正确配置了 iSCSI 启动器和目标。
    </para>
   </listitem>
   <listitem>
    <para>
     使用 DRBD* 实施在两台计算机间分发数据的镜像 RAID 系统时，请确保只访问 DRBD 提供的设备，切勿访问备份设备。请与群集的剩余节点使用相同（绑定）的 NIC 来调整此处提供的冗余。
    </para>
   </listitem>
  </itemizedlist>
  <para>
   如果使用 SBD 作为 STONITH 机制，则共享储存还需要满足其他要求。有关细节，请参见<xref linkend="sec.ha.storage.protect.req"/>。
   </para>
 </sect1>
 <sect1 xml:id="sec.ha.requirements.other">
  <title>其他要求和建议</title>

  <para>
   为了实现受支持且有用的高可用性设置，请考虑以下建议：
  </para>

  <variablelist>
   <varlistentry xml:id="vle.ha.req.nodes">
    <term>群集节点数</term>
    <listitem>
     <important>
      <title>奇数个数的群集节点</title>
      <para>
       对于包含三个以上节点的群集，强烈建议使用奇数数量的群集节点。
      </para>
      <para>为使服务保持运行状态，包含两个以上节点的群集依赖法定票数（多数票决）来解决群集分区。双节点或三节点群集只能容许每次有一个节点发生故障，而五节点群集可以容许两个节点发生故障，以此类推。
      </para>
     </important>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>时间同步</term>
     <listitem>
   <para>
     群集节点必须同步到群集外的 NTP 服务器。有关详细信息，请参见 SUSE Linux Enterprise Server <phrase role="productnumber"><phrase os="sles">12 SP3</phrase></phrase> 的《<citetitle>管理指南</citetitle>》：<link xlink:href="http://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html"/>。
    </para>
    <para>
     如果节点未同步，群集可能无法正常运作。此外，日志文件和群集报告在不进行同步的情况下也很难进行分析。如果使用引导脚本，而 NTP 尚未配置，则系统会提出警告。
    </para>
  </listitem>
   </varlistentry>
   <varlistentry>
    <term>网络接口卡 (NIC) 名称</term>
    <listitem>
     <para>
      必须在所有节点上都相同。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>主机名和 IP 地址</term>
    <listitem>
     <itemizedlist>
      <listitem>
       <para>
        使用静态 IP 地址。
       </para>
      </listitem>
      <listitem>
        <para>
     在 <filename>/etc/hosts</filename> 文件中列出了所有群集节点，包括其完全限定的主机名和简短主机名。群集成员必须能够按名称找到彼此。如果名称不可用，则将无法进行群集内部通讯。
   </para>
       <para>
        有关 Pacemaker 如何获取节点名称的细节，请参见 <link xlink:href="http://clusterlabs.org/doc/en-US/Pacemaker/1.1/html/Pacemaker_Explained/s-node-name.html"/>。
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
   </varlistentry>
   <varlistentry xml:id="vle.ha.req.ssh">
    <term>SSH</term>
    <listitem>
      <para>
    所有群集节点都必须能通过 SSH 相互访问。<command>crm report</command>（用于查错）等工具和 Hawk2 的<guimenu>历史记录浏览器</guimenu>要求节点之间采用无口令 SSH 访问方式，否则它们只能从当前节点收集数据。
  </para>
     <note>
      <title>合规要求</title>
      <para>
       如果无口令 SSH 访问不符合法规要求，您可以使用<xref linkend="app.crmreport.nonroot"/>中所述的变通方法来运行 <command>crm report</command>。
      </para>
      <para>
       对于<guimenu>历史记录浏览器</guimenu>，目前还没有其他方式可替代无口令登录。
      </para>
     </note>
    </listitem>
   </varlistentry>

  </variablelist>
 </sect1>
</chapter>
