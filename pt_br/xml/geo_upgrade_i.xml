<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="geo_upgrade_i.xml" version="5.0" xml:id="sec-ha-geo-upgrade">
 <title>Fazendo upgrade para a versão mais recente do produto</title>

 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer/>
        <dm:status>editando</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>yes (sim)</dm:translation>
        <dm:languages/>
        <dm:release/>
        <dm:repository/>
      </dm:docmanager>
    </info>
    <para> Para obter instruções gerais sobre como fazer upgrade de um cluster, consulte o <citetitle>Guia de Administração</citetitle> da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles">12 SP2</phrase></phrase>. Ele está disponível em <link xlink:href="http://www.suse.com/documentation/"/>. O capítulo <citetitle>Fazendo upgrade do cluster e atualizando pacotes de software</citetitle> também descreve as preparações que devem ser feitas antes de iniciar o processo de upgrade. </para>

 <table xml:id="table-ha-geo-upgrade-oview">
  <title>Caminhos de Upgrade Suportados para SLE HA e SLE HA Geo</title>
  <tgroup cols="3">
   <colspec colnum="1" colname="1" colwidth="25*"/>
   <colspec colnum="2" colname="2" colwidth="22*"/>
   <colspec colnum="3" colname="3" colwidth="53*"/>
   <thead>
    <row>
     <entry>
      <para> Upgrade de... para </para>
     </entry>
     <entry>
      <para> Caminho do Upgrade </para>
     </entry>
     <entry>
      <para> Para Obter Detalhes, Consulte </para>
     </entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry>
      <para> SLE HA 11 SP3 para SLE HA (Geo) 12 </para>
     </entry>
     <entry>
      <para> Migração offline </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Sistema de Base: <citetitle>Guia de Implantação do SUSE Linux Enterprise Server 12</citetitle>, parte <citetitle>Atualizando e fazendo upgrade do SUSE Linux Enterprise</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA: <citetitle>Guia de Administração da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 SP1</citetitle>, capítulo <citetitle>Fazendo upgrade do cluster e atualizando pacotes de software</citetitle>, seção <citetitle>Migração offline</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA Geo: <xref linkend="sec-ha-geo-upgrade-offline" xrefstyle="select:title nopage"/>
        </para>
       </listitem>
      </itemizedlist>
     </entry>
    </row>
    <row>
     <entry>
      <para> SLE HA (Geo) 11 SP4 para SLE HA (Geo) 12 SP1 </para>
     </entry>
     <entry>
      <para> Migração offline </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Sistema de Base: <citetitle>Guia de Implantação do SUSE Linux Enterprise Server 12 SP1</citetitle>, parte <citetitle>Atualizando e fazendo upgrade do SUSE Linux Enterprise</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA: <citetitle>Guia de Administração da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 SP1</citetitle>, capítulo <citetitle>Fazendo upgrade do cluster e atualizando pacotes de software</citetitle>, seção <citetitle>Migração offline</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA Geo: <xref linkend="sec-ha-geo-upgrade-arbitrators" xrefstyle="select:title nopage"/> </para>
       </listitem>
      </itemizedlist>
     </entry>
    </row>
    <row>
     <entry>
      <para> SLE HA (Geo) 12 para SLE HA (Geo) 12 SP1 </para>
     </entry>
     <entry>
      <para> Upgrade sequencial </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Sistema de Base: <citetitle>Guia de Implantação do SUSE Linux Enterprise Server 12 SP1</citetitle>, parte <citetitle>Atualizando e fazendo upgrade do SUSE Linux Enterprise</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA: <citetitle>Guia de Administração da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 SP1</citetitle>, capítulo <citetitle>Fazendo upgrade do cluster e atualizando pacotes de software</citetitle>, seção <citetitle>Upgrade sequencial</citetitle>
        </para>
       </listitem>
       <listitem>
         <para> SLE HA Geo: <xref linkend="sec-ha-geo-upgrade-arbitrators" xrefstyle="select:title nopage"/> </para>
        </listitem>
       </itemizedlist>
     </entry>
    </row>
    <row>
     <entry>
      <para> SLE HA (Geo) 12 SP1 para SLE HA (Geo) 12 SP2</para>
     </entry>
     <entry>
      <para> Upgrade sequencial </para>
     </entry>
     <entry>
      <itemizedlist>
       <listitem>
        <para> Sistema de Base: <citetitle>Guia de Implantação do SUSE Linux Enterprise Server 12 SP2</citetitle>, parte <citetitle>Atualizando e fazendo upgrade do SUSE Linux Enterprise</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA: <citetitle>Guia de Administração da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 SP2</citetitle>, capítulo <citetitle>Fazendo upgrade do cluster e atualizando pacotes de software</citetitle>, seção <citetitle>Upgrade sequencial</citetitle>
        </para>
       </listitem>
       <listitem>
        <para> SLE HA Geo: <xref linkend="sec-ha-geo-upgrade-arbitrators" xrefstyle="select:title nopage"/> </para>
       </listitem>
       <listitem>
        <para>DRBD 8 para DRBD 9: <citetitle>Guia de Administração da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 SP2</citetitle>, capítulo <citetitle>DRBD</citetitle>, seção <citetitle>Migrando do DRBD 8 para o DRBD 9</citetitle>
         </para>
       </listitem>
      </itemizedlist>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

 <sect2 xml:id="sec-ha-geo-upgrade-offline">
  <title>Migração offline</title>
  <para> Esta seção aborda os seguintes cenários: </para>
  <itemizedlist>
   <listitem>
    <para> Upgrade do SLE HA Geo 11 SP3 para o SLE HA Geo 12</para>
   </listitem>
  </itemizedlist>
  <para> A versão de booth (v0.1) na <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 11 a 11 SP3 baseava-se no algoritmo Paxos. A versão de booth (v0.2) na <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 11 SP4 e na <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 e 12 SPx baseia-se vagamente no raft e é incompatível com a execução da v0.1. Portanto, não é possível o upgrade sequencial de qualquer sistema que execute a versão de booth antiga para um que execute a nova versão de booth. Em vez disso, todos os nós do cluster devem estar offline, e o cluster precisa ser migrado como um todo, conforme descrito no <xref linkend="pro-ha-geo-upgrade-offline"/>.</para>
  <para> Devido ao novo recurso de multilocatário, o novo script init do arbitrador não pode parar nem testar o status do arbitrador Paxos v0.1. No upgrade para a v0.2, o arbitrador será interrompido, se estiver em execução. O agente de recurso OCF <literal>ocf:pacemaker:booth-site</literal> é capaz de parar e monitorar o daemon do site do booth v0.1. </para>

  <procedure xml:id="pro-ha-geo-upgrade-offline">
   <title>Executando uma migração de todo o cluster offline</title>
   <step>
    <para>Para fazer upgrade dos nós do cluster, siga as instruções no <citetitle>Guia de Administração da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> 12 SP1</citetitle>, capítulo <citetitle>Fazendo upgrade do cluster e atualizando pacotes de software</citetitle>, seção <citetitle>Migração offline</citetitle>. </para>
   </step>
   <step>
    <para> Se você usar arbitradores fora dos sites do cluster: </para>
    <substeps performance="required">
      <step>
      <para> Faça upgrade de cada arbitrador para a versão desejada do SUSE Linux Enterprise Server. Para obter os detalhes dos processos de upgrade individuais, consulte a <xref linkend="table-ha-geo-upgrade-oview"/>. </para>
     </step>
     <step>
      <para> Adicione a extensão de cluster Geo e instale os pacotes conforme descrito na <xref linkend="sec-ha-geo-inst-arbitrators"/>. </para>
     </step>
    </substeps>
   </step>
   <step>
    <para> Como a sintaxe e o algoritmo de consenso do booth foram mudados, você precisa atualizar os arquivos de configuração de booth para atender aos requisitos mais recentes. Antes você podia especificar o horário de vencimento e os pesos anexando-os ao nome do ticket com um ponto e vírgula (<literal>;</literal>) como separador. A nova sintaxe tem tokens separados para todas as opções de ticket. Consulte a <xref linkend="sec-ha-geo-booth"/> para obter os detalhes. Se você não especificou horário de vencimento ou pesos diferentes dos padrões e não deseja usar o recurso de multilocatário, você ainda pode usar o <filename>/etc/booth/booth.conf</filename> antigo. </para>
   </step>
   <step>
    <para> Sincronize os arquivos de configuração de booth atualizados em todos os sites e arbitradores do cluster. </para>
   </step>
   <step>
    <para> Inicie o serviço de booth nos sites e arbitradores do cluster, conforme descrito na <xref linkend="sec-ha-geo-setup-booth-service"/>. </para>
   </step>
  </procedure>
 </sect2>
 <sect2 xml:id="sec-ha-geo-upgrade-arbitrators">
  <title>Upgrade do arbitrador</title>
  <para> Esta seção aborda os seguintes cenários: </para>
  <itemizedlist>
   <listitem>
    <para> Upgrade do SLE HA Geo 11 SP4 para o SLE HA Geo 12 SP1 </para>
   </listitem>
   <listitem>
    <para> Upgrade do SLE HA Geo 12 para o SLE HA Geo 12 SP1</para>
   </listitem>
   <listitem>
    <para> Upgrade do SLE HA Geo 12 SP1 para o SLE HA Geo 12 SP2</para>
   </listitem>
  </itemizedlist>

  <procedure xml:id="pro-ha-geo-upgrade-arbitrators">
   <title>Fazendo upgrade de arbitradores fora do cluster</title>
   <para> Se você usa arbitradores fora dos sites do cluster, faça o seguinte para cada arbitrador:</para>
  <step>
    <para>Execute um upgrade para a versão de destino desejada do SUSE Linux Enterprise Server. Para obter os detalhes dos processos de upgrade individuais, consulte a <xref linkend="table-ha-geo-upgrade-oview"/>.</para>
   </step>
   <step>
    <para> Adicione a extensão de cluster Geo e instale os pacotes conforme descrito na <xref linkend="sec-ha-geo-inst-arbitrators"/>. </para>
   </step>
  </procedure>
 </sect2>
</sect1>
