<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ha_hawk2_maintenance_i.xml" version="5.0" xml:id="sec-conf-hawk2-maintenance">
 <title>使用維護模式</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>編輯</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>
   <para>
   您可能不時地需要對個別叢集元件或整個叢集執行測試或維護任務 — 變更叢集組態、更新個別節點的軟體套件，或者將叢集升級到更高的產品版本。
  </para>
  <para>
  為此，High Availability Extension 提供了針對多個層級的 <literal>maintenance</literal> 選項︰
 </para>

 <itemizedlist>
  <listitem>
   <para>
    <xref linkend="sec-conf-hawk2-maint-rsc" xrefstyle="select:title"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec-conf-hawk2-maint-nodes" xrefstyle="select:title"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec-conf-hawk2-maint-cluster" xrefstyle="select:title"/>
   </para>
  </listitem>
 </itemizedlist>

  <warning>
   <title>資料遺失的風險</title>
   <para>當服務在叢集控制下執行時，如果您需要執行任何測試或維護任務，請務必遵循以下指南︰</para>
   <orderedlist>
    <listitem>
     <para>在開始之前，請將個別資源、節點或整個叢集設定為維護模式。這有助於避免一些不利的負面影響，例如，資源不按順序啟動、出現叢集節點間 CIB 不同步或資料遺失的風險。 </para>
    </listitem>
    <listitem>
     <para>執行維護任務或測試。</para>
    </listitem>
    <listitem>
     <para>完成後，請解除維護模式以開始正常的叢集操作。</para>
    </listitem>
   </orderedlist>
  </warning>

  <para>
  如需處於維護模式的資源和叢集會發生之情況的詳細資料，請參閱<xref linkend="sec-ha-config-basics-maint-mode"/>。
 </para>

 <sect2 xml:id="sec-conf-hawk2-maint-rsc">
  <title>向資源套用維護模式</title>
  <procedure>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     從左側導覽列中，選取<menuchoice><guimenu>監控</guimenu>
     <guimenu>狀態</guimenu></menuchoice>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>資源</guimenu>索引標籤上，選取您要置於維護模式的資源。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>操作</guimenu>欄中按一下資源旁邊的向下箭頭圖示，然後選取<guimenu>維護</guimenu>。確認您的選擇。
    </para>
    <para>
     <guimenu>狀態</guimenu>螢幕便會更新。<guimenu>狀態</guimenu>欄現在會為資源顯示<guimenu>維護模式</guimenu>圖示。資源旁邊的<guimenu>操作</guimenu>欄也會變更。
    </para>
   </step>
   <step>
    <para>
     完成資源的維護任務。
    </para>
   </step>
   <step>
    <para>
     若要停用資源的維護模式，請轉到<guimenu>操作</guimenu>欄並按一下<guimenu>停用維護模式</guimenu>。
    </para>
    <para>
     從此時起，資源將重新由 High Availability Extension 軟體管理。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-conf-hawk2-maint-nodes">
  <title>向節點套用維護模式</title>
  <para>
   有時，需要將個別節點置於維護模式。
  </para>
  <procedure>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     從左側導覽列中，選取<menuchoice><guimenu>監控</guimenu>
     <guimenu>狀態</guimenu></menuchoice>，並切換到<guimenu>節點</guimenu>索引標籤。
    </para>
    <para>
     在<guimenu>節點</guimenu>索引標籤上，<guimenu>維護</guimenu>欄會顯示節點的狀態︰紅色圖示表示該節點處於維護模式。綠色圖示表示該節點處於正常模式，並可切換到維護模式。
    </para>
   </step>
   <step>
    <para>
     若要將節點切換到維護模式，請按一下<guimenu>維護</guimenu>列中的圖示，並確認您的選擇。
    </para>
    <para>
     如此會將以下例項屬性新增至該節點︰<literal>maintenance="true"</literal>。先前在此節點上執行的資源將變為<literal>不受管理</literal>狀態。在該節點脫離維護模式之前，系統將不會為其配置任何新的資源。
    </para>
   </step>
   <step>
    <para>
     完成節點的維護任務。
    </para>
   </step>
   <step>
    <para>
     若要停用節點的維護模式，請再次按一下<guimenu>維護</guimenu>列中的圖示，並確認您的選擇。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-conf-hawk2-maint-cluster">
  <title>向叢集套用維護模式</title>
  <para>
   若要為整個叢集設定或取消設定維護模式，請執行下列步驟︰
  </para>
  <procedure>
   <step>
    <para>
     登入 Hawk2︰
    </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para>
     從左側導覽列中，選取<menuchoice>
     <guimenu>組態</guimenu><guimenu>叢集組態</guimenu>
     </menuchoice>。
    </para>
   </step>
   <step>
    <para>
     在螢幕的<guimenu>叢集組態</guimenu>部分，從空下拉式方塊中選取 <guimenu>maintenance-mode</guimenu> 屬性。
    </para>
   </step>
   <step>
    <para>
     若要將叢集置於維護模式，請將 <guimenu>maintenance-mode</guimenu> 的值設定為 <literal>Yes</literal> 並套用您的變更。
    </para>
   </step>
   <step>
    <para>
     完成整個叢集的維護任務。
    </para>
   </step>
   <step>
    <para>
     若要停用叢集的維護模式，請將 <guimenu>maintenance-mode</guimenu> 的值設定為 <literal>no</literal> 並套用此變更。
    </para>
    <para>
     從此刻起，High Availability Extension 會再次接管叢集管理工作。
    </para>
   </step>
  </procedure>
 </sect2>
</sect1>
