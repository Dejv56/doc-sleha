<?xml version="1.0" encoding="UTF-8"?>
<sect2 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="geo_manage_hawk2_i.xml" xml:id="sec-ha-geo-manage-hawk2" version="5.0">
 <title>HA Web Konsole (Hawk2)の使用</title>

 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer/>
        <dm:status>編集</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>yes</dm:translation>
        <dm:languages/>
        <dm:release/>
        <dm:repository/>
      </dm:docmanager>
    </info>
    <para>Hawk2は、クラスタとGeoクラスタを管理するためのWebベースのユーザインタフェースです。</para>

  <sect3 xml:id="sec-ha-geo-manage-hawk2-dashboard">

   <title>Hawk2ダッシュボードを使用した複数クラスタの監視</title>
   <para>
    <guimenu>Dashboard (ダッシュボード)</guimenu>に表示されるクラスタ情報はサーバ側に保存されており、クラスタノード間で同期されます(クラスタノード間でのパスワード不要のSSHアクセスが設定されている場合)。詳細については、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>の『<citetitle>Administration Guide</citetitle>』(<link xlink:href="http://www.suse.com/documentation/"/>から入手可能)を参照してください。「<citetitle>Running Cluster Reports Without <systemitem class="username">root</systemitem> Access</citetitle>」という章の「<citetitle>Configuring a Passwordless SSH Account</citetitle>」という節を参照してください。ただし、Hawk2を実行するマシンは、その目的のためにクラスタの一部である必要はなく、別個の無関係のシステムで構いません。
   </para>
  <procedure xml:id="pro-ha-config-hawk2-geo-dashboard">
   <title>Hawk2による複数クラスタの監視</title>
   <itemizedlist>
    <title>前提条件</title>
    <listitem>
     <para> Hawk2の<guimenu>Dashboard (ダッシュボード)</guimenu>で監視するすべてのクラスタでは、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase> <phrase role="productnumber"><phrase os="sles">12 SP2</phrase></phrase>を実行している必要があります。 それより前のバージョンの<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise High Availability Extension</phrase></phrase>を実行しているクラスタは監視できません。 </para>
    </listitem>
    <listitem>
     <para>すべてのクラスタノードにあるHawk2の自己署名証明書を独自の証明書(または公式認証局によって署名された証明書)で置き換えていない場合は、<emphasis/>「すべての」クラスタの<emphasis/>「すべての」ノードで、少なくとも1回はHawkにログインします。証明書を検証します(または、ブラウザで例外を追加して警告をスキップします)。
     </para>
    </listitem>
   </itemizedlist>
   <step>
    <para> 複数のクラスタを監視するマシン上で、Hawk2 Webサービスを開始します。 </para>
    <screen><prompt role="root">root # </prompt><command>systemctl</command> start hawk</screen>
   </step>
   <step>
    <para> Webブラウザを起動して、Hawk2を実行するマシンのIPアドレスまたはホスト名をURLとして入力します。</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para> Hawk2 Webインタフェースにログインします。 </para>
   </step>
   <step>
    <para>左のナビゲーションバーから、<guimenu>Dashboard (ダッシュボード)</guimenu>を選択します。 </para>
   </step>
   <step>
    <para>複数のクラスタのダッシュボードを追加するため、<guimenu>Add Cluster (クラスタの追加)</guimenu>をクリックします。</para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk2-dashboard-add-cluster.png" width="100%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk2-dashboard-add-cluster.png" width="95%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
    <substeps>
     <step>
      <para> <guimenu>Dashboard (ダッシュボード)</guimenu>でクラスタを識別するためのカスタムクラスタ名を<guimenu>クラスタ名</guimenu>に入力します。 </para>
     </step>
     <step>
      <para>クラスタ内のノードのホスト名を<guimenu>Hostname of a node in the cluster (クラスタ内のノードのホスト名)</guimenu>に入力します。</para>
     </step>
    
     <step>
      <para><guimenu>Add (追加)</guimenu>をクリックして、変更を確認します。</para>
     </step>
     <step>
      <para> ダッシュボードにクラスタをさらに追加するには、もう一度<guimenu>Add Cluster (クラスタの追加)</guimenu>をクリックして、次のクラスタの詳細を入力します。 </para>
      <figure>
       <title>Hawk2 - ダッシュボード</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="hawk2-dashboard-multiple-clusters.png" width="100%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="hawk2-dashboard-multiple-clusters.png" width="80%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </figure>
     </step>
    </substeps>
   </step>
   <step>
    <para> ダッシュボードからクラスタを削除するには、クラスタの名前の横にある<literal>x</literal>アイコンをクリックします。 </para>
   </step>
   <step>
    <para> クラスタの詳細を表示するには、パスワードを入力して、<guimenu>Connect (接続)</guimenu>をクリックします。 </para>
    <para> それぞれのノード、リソース、およびチケットの状態と共にサマリが表示されます。クラスタ名をクリックすると、クラスタの<guimenu>Status (状態)</guimenu>画面が表示されます。ここから、通常の方法でクラスタを管理できます。</para>
   </step>
  </procedure>
   <para>
    ノードまたはリソースに関するステータス変更は、<guimenu> Dashboard</guimenu>内でほぼ即時に反映されます。
   </para>
  </sect3>
 <sect3 xml:id="sec-ha-geo-manage-hawk2-tickets">
  <title>Hawk2を使用したチケットの管理</title>
  <para>
   Hawk2でチケットを表示できるのは、それらのチケットが少なくとも1回付与または取り消しされた場合や、それらのチケットがチケットの依存関係で参照されている場合です。 </para>
  <para>Hawk2では、以下のチケットステータスが表示されます。</para>
  <itemizedlist>
   <listitem>
    <para><guimenu>Granted (付与済み)</guimenu>: 現在のサイトに付与されているチケット。</para>
   </listitem>
   <listitem>
    <para>
     <guimenu>Elsewhere (他のサイト)</guimenu>: 別のサイトに付与されているチケット。</para>
   </listitem>
   <listitem>
    <para>
     <guimenu>Revoked (取り消し済み)</guimenu>: 取り消されたチケット。これ以外に、Hawk2でチケットが取り消し済みとして表示されるケースは、それらのチケットがチケットの依存関係で参照されているが、どのサイトにもまだ付与されていない場合です。</para>
   </listitem>
  </itemizedlist>
  <note>
   <title>現在のサイトへのチケットの付与とチケットの取り消し</title>
   
   <para> Hawk2を使用してすべてのサイトのチケットを表示できますが、Hawk2によってトリガされた付与操作や取り消し操作は、現在のサイト(Hawk2を使用して現在接続しているサイト)のみに適用されます。Geoクラスタの別のサイトにチケットを付与するには、そのサイトに属しているいずれかのクラスタノード上でHawk2を起動します。</para>
   <para>どのサイトにもまだ付与されていないチケットのみを付与できます。</para>
  </note>

  <procedure xml:id="pro-ha-config-hawk2-viewtickets">
   <title>Hawk2を使用したチケットの表示、付与、および取り消し</title>

   <step>
    <para> Webブラウザを起動して、Hawk2にログインします。 </para>
   </step>
   <step>
    <para> 左のナビゲーションバーで、<guimenu>Status (状態)</guimenu>を選択します。</para>
    <para> クラスタノードとリソースに関する情報とともに、Hawk2には<guimenu>チケット</guimenu>カテゴリも表示されます。このカテゴリには、チケットのステータス、チケットを参照している制約のID、およびチケット名が表示されます。<guimenu>チケット</guimenu>カテゴリには、チケットを管理するための2つのカラムも含まれています。</para>
   </step>
   <step>
    <para> 特定のチケットの詳細を表示するには、そのチケットの横にある<guimenu>詳細</guimenu>アイコンをクリックします。そのチケットがすでに付与されているかどうか、設定されている<guimenu>Loss Policy (喪失ポリシー)</guimenu> (チケットがサイトから取り消された場合の処理)、およびそのチケットに依存しているリソースがウィンドウに表示されます。</para>
    <figure>
     <title>Hawk2 － チケットの詳細</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk2-geo-ticket-details.png" width="100%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk2-geo-ticket-details.png" width="80%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step>
    <para> 付与済みのチケットを現在のサイトから取り消すには、またはチケットを現在のサイトに付与するには、そのチケットの横にある<guimenu>Granted (付与済み)</guimenu>カラムのスイッチをクリックします。クリックすると、使用可能な操作が表示されます。Hawk2で確認プロンプトが表示されたら、選択内容を確定します。 </para>
    <para> いかなる理由でもそのチケットを付与することも取り消すこともできない場合は、Hawk2にはエラーメッセージが表示されます。チケットが正常に付与または取り消された場合は、そのチケットの<guimenu>Status (ステータス)</guimenu>が更新されます。 </para>
   </step>
  </procedure>
  <para>
   <remark>taroth 2015-11-02: according to dzyuzin, simulating granting and revoking tickets with
    hawk2 does not work yet, therefore commenting the following procedure</remark>
  </para>
  
  
 </sect3>
 </sect2>
